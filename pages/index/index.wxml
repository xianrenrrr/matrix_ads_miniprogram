<!-- pages/index/index.wxml -->
<view class="page-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <view class="loading-spinner"></view>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view wx:else class="container">
    <!-- æ¬¢è¿ä¿¡æ¯ -->
    <view class="card">
      <view class="flex justify-between items-center">
        <view>
          <view class="card-title">ä½ å¥½ï¼Œ{{userInfo.username || 'ç”¨æˆ·'}}</view>
          <view class="card-subtitle">å¼€å§‹ä»Šå¤©çš„åˆ›ä½œå§</view>
        </view>
        <button class="btn btn-primary" bindtap="startRecording">
          å¼€å§‹å½•åˆ¶
        </button>
      </view>
    </view>

    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-grid">
      <view class="stat-card">
        <view class="stat-number text-primary">{{stats.availableTemplates}}</view>
        <view class="stat-label">å¯ç”¨æ¨¡æ¿</view>
      </view>
      <view class="stat-card">
        <view class="stat-number text-success">{{stats.recordedVideos}}</view>
        <view class="stat-label">å·²å½•åˆ¶</view>
      </view>
      <view class="stat-card">
        <view class="stat-number text-warning">{{stats.publishedVideos}}</view>
        <view class="stat-label">å·²å‘å¸ƒ</view>
      </view>
    </view>

    <!-- æœ€è¿‘æ¨¡æ¿ -->
    <view class="card">
      <view class="flex justify-between items-center mb-24">
        <view class="card-title">æœ€è¿‘æ¨¡æ¿</view>
        <text class="text-primary" bindtap="viewAllTemplates">æŸ¥çœ‹å…¨éƒ¨</text>
      </view>
      
      <view wx:if="{{recentTemplates.length === 0}}" class="text-secondary text-center p-32">
        æš‚æ— æ¨¡æ¿
      </view>
      
      <view wx:else class="template-list">
        <view 
          wx:for="{{recentTemplates}}" 
          wx:key="id" 
          class="template-item"
          data-id="{{item.id}}"
          bindtap="selectTemplate"
        >
          <view class="template-thumbnail">
            <image src="{{item.exampleFrame || '/assets/default-template.jpg'}}" mode="aspectFill" class="thumbnail-image"></image>
          </view>
          <view class="template-info">
            <view class="template-title">{{item.templateTitle || 'æ¨¡æ¿'}}</view>
            <view class="template-desc text-secondary">{{item.targetAudience || 'é€šç”¨æ¨¡æ¿'}}</view>
            <view class="template-duration text-xs text-secondary">{{item.totalVideoLength || 30}}ç§’ Â· {{item.tone || 'è½»æ¾'}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <view class="card">
      <view class="card-title mb-24">å¿«é€Ÿæ“ä½œ</view>
      <view class="quick-actions">
        <button class="action-btn" bindtap="viewAllTemplates">
          <text class="action-icon">ğŸ“š</text>
          <text class="action-text">æµè§ˆæ¨¡æ¿</text>
        </button>
        <button class="action-btn" bindtap="startRecording">
          <text class="action-icon">ğŸ“¹</text>
          <text class="action-text">å¼€å§‹å½•åˆ¶</text>
        </button>
        <button class="action-btn" bindtap="handleLogout">
          <text class="action-icon">ğŸšª</text>
          <text class="action-text">é€€å‡ºç™»å½•</text>
        </button>
      </view>
    </view>
  </view>
</view>