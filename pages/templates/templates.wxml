<!-- pages/templates/templates.wxml -->
<view class="templates-container">
  <!-- æœç´¢æ  -->
  <view class="search-section">
    <view class="search-box">
      <text class="search-icon">ğŸ”</text>
      <input 
        type="text"
        class="search-input"
        placeholder="æœç´¢æ¨¡æ¿..."
        placeholder-class="search-placeholder"
        value="{{searchText}}"
        bindinput="onSearchInput"
      />
    </view>
  </view>


  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-section">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½æ¨¡æ¿ä¸­...</text>
  </view>

  <!-- æ¨¡æ¿åˆ—è¡¨ -->
  <view wx:else class="templates-list">
    <view wx:if="{{templates.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-title">æš‚æ— æ¨¡æ¿</text>
      <text class="empty-desc">è¯·è”ç³»ç®¡ç†å‘˜åˆ†é…æ¨¡æ¿æˆ–åœ¨ç½‘é¡µç«¯è®¢é˜…</text>
    </view>

    <view wx:else class="template-grid">
      <view 
        wx:for="{{templates}}" 
        wx:key="id"
        class="template-card {{!item.isSubscribed ? 'unsubscribed' : ''}}"
      >
        <!-- æ¨¡æ¿ç¼©ç•¥å›¾ -->
        <view class="template-thumbnail">
          <image 
            src="{{item.thumbnail}}" 
            mode="aspectFill" 
            class="thumbnail-image"
            lazy-load="true"
          ></image>
          
          <!-- è®¢é˜…çŠ¶æ€æ ‡è¯† -->
          <view wx:if="{{!item.isSubscribed}}" class="subscription-badge">
            <text class="badge-text">æœªè®¢é˜…</text>
          </view>
          
          <!-- éš¾åº¦æ ‡è¯† -->
          <view class="difficulty-badge" style="background-color: {{getDifficultyColor(item.difficulty)}}">
            <text class="difficulty-text">{{getDifficultyText(item.difficulty)}}</text>
          </view>
        </view>

        <!-- æ¨¡æ¿ä¿¡æ¯ -->
        <view class="template-info">
          <view class="template-header">
            <text class="template-title">{{item.templateTitle || 'è§†é¢‘æ¨¡æ¿'}}</text>
            <view class="template-stats">
              <text class="stat-item">{{item.sceneCount}}åœºæ™¯</text>
              <text class="stat-divider">Â·</text>
              <text class="stat-item">{{item.duration}}ç§’</text>
            </view>
          </view>
          
          <text class="template-description">{{item.targetAudience || 'é€šç”¨æ¨¡æ¿'}} Â· {{item.tone || 'è½»æ¾é£æ ¼'}}</text>
          
          <!-- æ ‡ç­¾ -->
          <view class="template-tags">
            <text class="tag-item">{{item.videoFormat || '1080p'}}</text>
            <text class="tag-item">{{item.tone || 'è½»æ¾'}}</text>
            <text wx:if="{{item.lightingRequirements}}" class="tag-item">{{item.lightingRequirements}}</text>
          </view>
          
          <!-- åˆ›å»ºè€…ä¿¡æ¯ -->
          <view class="template-footer">
            <text class="creator-info">å†…å®¹ç®¡ç†å‘˜åˆ›å»º</text>
            
            <!-- æ“ä½œæŒ‰é’® -->
            <view class="template-actions" wx:if="{{item.isSubscribed}}">
              <button 
                class="action-btn primary-btn"
                data-id="{{item.id}}"
                bindtap="startRecording"
                size="mini"
              >
                å¼€å§‹å½•åˆ¶
              </button>
            </view>
            
            <view class="template-actions" wx:else>
              <button 
                class="action-btn subscribe-btn"
                data-id="{{item.id}}"
                bindtap="subscribeTemplate"
                size="mini"
              >
                å»è®¢é˜…
              </button>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æç¤º -->
  <view class="bottom-tips">
    <text class="tip-text">ğŸ’¡ åœ¨ç½‘é¡µç«¯å¯ä»¥è®¢é˜…æ›´å¤šæ¨¡æ¿</text>
  </view>
</view>